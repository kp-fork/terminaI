# TerminaI Go-Live Handoff Prompt

**Date:** December 24, 2024 **Context:** Preparing TerminaI for public launch
(100 stars milestone)

---

## Project Overview

TerminaI is a fork of `gemini-cli` that adds:

- **Desktop App** (Tauri + React) with voice support
- **A2A/Web Remote** - control terminal from phone/browser
- **Safety Ladder** - PIN-protected approvals for dangerous commands
- **Voice Mode** - offline STT/TTS with barge-in

Repository: `/home/profharita/Code/terminaI`

---

## What Was Done This Session

### 1. A2A Fixes (COMPLETED)

- **Port Mismatch Fixed:** Changed CLI default port from `0` (random) to `41242`
  in `packages/cli/src/gemini.tsx:488`
- **Terminal Visibility Fixed:** Added `tool-call-update` event handler in
  `packages/desktop/src/hooks/useCliProcess.ts` to display tool execution output

### 2. Investigation Report Created

- **File:** `.local/A2A_INVESTIGATION_REPORT.md`
- Contains full architecture diagram, token flow, CORS config, and potential
  issues

### 3. Task Files Created

- **`.local/TASKS_AGENT.md`** — Mechanical tasks (version cleanup, docs)
- **`.local/TASKS_A2A_INVESTIGATION.md`** — Pre-investigation checklist
- **`.local/TASKS_COLLABORATIVE.md`** — High-reasoning tasks (A2A testing, npm
  setup, launch prep)

---

## Immediate Next Steps

### Priority 1: Test A2A Locally

```bash
# Rebuild after fixes
npm run build

# Start CLI with web-remote
terminai --web-remote --web-remote-rotate-token
# Copy the displayed token

# Open Desktop app, set:
# - Agent URL: http://127.0.0.1:41242
# - Token: (paste token)
# Test sending a message
```

### Priority 2: npm Distribution Setup

1. Create npm account at npmjs.com
2. Create @terminai organization
3. Generate access token
4. Add NPM_TOKEN to GitHub Secrets

### Priority 3: A2A Remote Testing

See `.local/TASKS_COLLABORATIVE.md` Section 5 for:

- Local network test (phone on same WiFi)
- Tunneling test (cloudflared/ngrok)
- Security verification

---

## Key Files to Know

| Purpose            | File                                          |
| ------------------ | --------------------------------------------- |
| CLI entry          | `packages/cli/src/gemini.tsx`                 |
| A2A server         | `packages/a2a-server/src/http/app.ts`         |
| Desktop hook       | `packages/desktop/src/hooks/useCliProcess.ts` |
| Web remote startup | `packages/cli/src/utils/webRemoteServer.ts`   |
| CORS config        | `packages/a2a-server/src/http/cors.ts`        |
| Auth middleware    | `packages/a2a-server/src/http/auth.ts`        |

---

## Known Issues (From Investigation)

1. **HMAC Not Validated Server-Side** — Client sends signature but server
   ignores it
2. **Replay Protection Disabled** — TODO comment in `app.ts:37`
3. **Token Not Shown After First Run** — Use `--web-remote-rotate-token` to get
   a new one

---

## Decisions Made

| Topic         | Decision                        |
| ------------- | ------------------------------- |
| macOS support | Coming Soon (no access to test) |
| Voice mode    | Coming Soon / Beta              |
| Homebrew      | Coming Soon                     |
| Default port  | 41242 (matches Desktop)         |

---

## To Resume Work

1. **Read this file** to get context
2. **Check `.local/TASKS_COLLABORATIVE.md`** for current task list
3. **Test A2A locally** before moving to remote testing
4. **Build and verify** with `npm run build && npm run preflight`

---

_Generated by Opus session on Dec 24, 2024_
